# 论文图表绘制脚本

## 目录说明

本目录包含论文各图表的R绘图脚本,按图号组织。

## 各图主题

### Figure 2 (3个文件)
**主题**: 序列保守性分析
- 3N保守性散点图
- IDR区域分析
- PhastCons保守性评分

### Figure 3 (8个文件)
**主题**: 基因表达模式和早晚期基因
- 早期和晚期基因识别
- PSI动态变化
- 表达模式聚类
- 柱形图和3D可视化

### Figure 4 (18个文件)
**主题**: 外显子保守性和Motif
- 上下调外显子分析
- PhastCons/3N/IDR综合分析
- 家蚕组织特异性分析
- DevAS过滤和筛选
- 多个子图(A, E, G等)

### Figure 5 (11个文件)
**主题**: 微外显子和DevAS统计
- 6个子图(A-F)
- 微外显子统计
- 四个时期汇总
- 上下调事件统计

### Figure 6 (19个文件)
**主题**: 同源性和进化分析
- 新外显子识别
- 物种特异性分析
- 全变态特异AS
- 同源组统计
- 进化树
- 多个子图(B, C, G, H)

### Figure 7 (1个文件)
**主题**: 测试和验证
- 测试脚本

### Figure 8 (4个文件)
**主题**: AS变异和方差分析
- AS方差分析
- 优化版柱形图

## 使用说明

### 通用流程
```bash
# 进入对应图表目录
cd figure{N}/

# 运行绘图脚本
Rscript plot_{subplot}.R
```

### 依赖包
```R
library(ggplot2)
library(dplyr)
library(tidyr)
library(cowplot)  # 图表组合
library(ggtree)   # 进化树(Figure 6)
```

### 输出格式
- PDF: 高质量矢量图
- PNG: 位图(可选)

## 注意事项

1. **数据路径**: 确保输入数据路径正确
2. **字体设置**: 部分脚本可能需要特定字体
3. **图表尺寸**: 可在脚本中调整输出尺寸
4. **颜色方案**: 保持一致性

## 文件命名规则
- `plot_{N}_{subplot}.R`: 主图脚本
- `sandiantu_*.R`: 散点图
- `zhuxingtu*.R`: 柱形图
- `*_youhua.R`: 优化版本
